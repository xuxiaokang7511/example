(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ee380354"],{1669:function(e,t,r){},5257:function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("content-main",{staticStyle:{"padding-left":"16px","padding-right":"16px","padding-bottom":"10px"},attrs:{"title-height":"48px","show-foot":""},scopedSlots:e._u([{key:"title",fn:function(){return[r("span",{staticStyle:{"font-size":"14px","font-weight":"bold"}},[e._v(e._s(e.isEdit?"\u7f16\u8f91\u89d2\u8272":"\u521b\u5efa\u89d2\u8272"))])]},proxy:!0},{key:"right",fn:function(){return[r("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-right":"18px"},attrs:{size:"mini",icon:e.isEdit?"el-icon-edit":"el-icon-plus"},on:{click:e.confirmRole}},[e._v(e._s(e.isEdit?"\u4fdd\u5b58":"\u786e\u5b9a"))])]},proxy:!0}])},[e._v(" "),e._v(" "),r("div",{staticStyle:{"padding-left":"16px","padding-right":"16px","padding-top":"10px"}},[r("el-form",{ref:"role",attrs:{model:e.role,rules:e.roleRules,"label-width":"80px","label-position":"left"}},[r("el-form-item",{attrs:{label:"\u89d2\u8272\u540d\u79f0",prop:"roleName"}},[r("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"\u89d2\u8272\u540d\u79f0",maxlength:"10"},model:{value:e.role.roleName,callback:function(t){e.$set(e.role,"roleName",t)},expression:"role.roleName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"\u62e5\u6709\u6743\u9650"}},[r("el-tree",{ref:"tree",staticStyle:{"margin-top":"8px",width:"300px"},attrs:{data:e.menuList,"show-checkbox":"","node-key":"id","default-expand-all":""}})],1)],1)],1)])},n=[],s=r("a34a"),a=r.n(s);function o(e){return u(e)||c(e)||l()}function l(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function u(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}function d(e,t,r,i,n,s,a){try{var o=e[s](a),l=o.value}catch(e){return void r(e)}o.done?t(l):Promise.resolve(l).then(i,n)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var s=e.apply(t,r);function a(e){d(s,i,n,a,o,"next",e)}function o(e){d(s,i,n,a,o,"throw",e)}a(void 0)}))}}var p={roleId:"",roleName:"",createTime:"",updateTime:"",permissions:[],deleteStatus:1},f={name:"RoleDetail",props:{isEdit:{type:Boolean,default:!1}},data:function(){return{loading:!1,listLoading:!0,role:Object.assign({},p),roleRules:{roleName:[{required:!0,message:"\u8bf7\u8f93\u5165\u89d2\u8272\u79f0",trigger:["blur","change"]}]},menuList:[]}},created:function(){this.init()},methods:{init:function(){if(this.getMenus(),this.isEdit){var e=this.$route.params&&this.$route.params.id;e&&"EditRolePermission"===this.$route.name&&this.getRole(e,this.$route)}else this.listLoading=!1,this.role=Object.assign({},p)},getRole:function(){var e=h(a.a.mark((function e(t,r){var i,n,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.listLoading=!0,e.next=4,this.$store.dispatch("permission/getRole",t);case 4:i=e.sent,n=i.data,this.role=n,this.setArr(this.role.menuList),this.listLoading=!1,s="".concat(this.$store.getters.menuObj[this.$route.name]&&this.$store.getters.menuObj[this.$route.name].label||"\u7f16\u8f91\u89d2\u8272","-").concat(t),this.setRouteTitle(s,r),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](0),this.listLoading=!1;case 16:case"end":return e.stop()}}),e,this,[[0,13]])})));function t(t,r){return e.apply(this,arguments)}return t}(),getMenus:function(){var e=h(a.a.mark((function e(){var t;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.$store.dispatch("permission/getMenus");case 3:t=e.sent,this.menuList=t.data,e.next=9;break;case 7:e.prev=7,e.t0=e["catch"](0);case 9:case"end":return e.stop()}}),e,this,[[0,7]])})));function t(){return e.apply(this,arguments)}return t}(),getArr:function(){var e=[].concat(o(this.$refs.tree.getCheckedKeys()),o(this.$refs.tree.getHalfCheckedKeys()));return e},clearArr:function(){this.$refs.tree.setCheckedKeys([])},setArr:function(e){var t=this;e=e.filter((function(e){return t.$refs.tree.getNode(e).isLeaf})),this.$refs.tree.setCheckedKeys(e)},confirmRole:function(){var e=this;this.$refs.role.validate((function(t){if(!t)return!1;e.loading=!0,e.submitRole()}))},submitRole:function(){var e=h(a.a.mark((function e(){var t,r,i,n,s;return a.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=this.getArr(),e.prev=2,this.role.permissions=t,r=this.role,i=r.roleId,n=r.roleName,s={roleId:i,roleName:n.trim()},!this.isEdit){e.next=11;break}return e.next=9,this.$store.dispatch("permission/updateRoleMenu",{list:t,sysRole:s});case 9:e.next=15;break;case 11:return e.next=13,this.$store.dispatch("permission/addRoleMenu",{list:t,sysRole:s});case 13:this.$refs["role"].resetFields(),this.clearArr();case 15:this.loading=!1,this.$notify({title:"\u6210\u529f",dangerouslyUseHTMLString:!0,message:"\n            <div>\u89d2\u8272\u540d\u79f0: ".concat(n,"</div>\n            <div>\u62e5\u6709\u83dc\u5355: ").concat(t.length,"\u4e2a</div>\n          "),type:"success"}),e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](2),this.loading=!1;case 22:case"end":return e.stop()}}),e,this,[[2,19]])})));function t(){return e.apply(this,arguments)}return t}()}},m=f,g=(r("70d3"),r("2877")),v=Object(g["a"])(m,i,n,!1,null,"81290c28",null);t["a"]=v.exports},"70d3":function(e,t,r){"use strict";var i=r("1669"),n=r.n(i);n.a},7897:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("role-detail",{ref:"detail",attrs:{"is-edit":!0}})},n=[],s=r("5257"),a={name:"EditRolePermission",components:{RoleDetail:s["a"]}},o=a,l=r("2877"),c=Object(l["a"])(o,i,n,!1,null,null,null);t["default"]=c.exports}}]);