(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72b1263c"],{"0ae1":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{staticClass:"h-full",staticStyle:{"padding-bottom":"10px"},attrs:{type:"flex",justify:"space-around"}},[n("el-col",{staticClass:"h-full",staticStyle:{"padding-left":"16px"},style:{"padding-right":e.handleType?"0":"16px"},attrs:{span:e.handleType?14:24}},[n("content-main",{attrs:{"title-height":"48px"},scopedSlots:e._u([{key:"title",fn:function(){return[n("span",{staticStyle:{"font-size":"16px","font-weight":"bold"}},[e._v("\u83dc\u5355\u76ee\u5f55")]),e._v(" "),e.handleType?e._e():n("span",{staticStyle:{"font-size":"12px"}},[e._v("(\u53ef\u62d6\u52a8\u6392\u5e8f)")])]},proxy:!0},{key:"right",fn:function(){return[e.handleType?e._e():n("el-button",{staticStyle:{"margin-right":"18px"},attrs:{size:"mini",type:"text"},on:{click:e.addRootNode}},[e._v("\u521b\u5efa\u6839\u83dc\u5355")])]},proxy:!0}])},[e._v(" "),e._v(" "),n("el-tree",{attrs:{data:e.menuList,"node-key":"id","default-expand-all":"",draggable:"","highlight-current":!!e.handleType,"allow-drag":e.allowDrag,"expand-on-click-node":!1},on:{"node-drag-start":e.handleDragStart,"node-drag-end":e.handleDragEnd,"node-drop":e.handleDrop},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node,i=t.data;return n("span",{staticClass:"custom-tree-node"},[n("span",[n("svg-icon",{attrs:{"icon-class":i.icon,size:"12px"}}),e._v(" "),n("span",{staticStyle:{"padding-left":"4px"}},[e._v(e._s(i.label))])],1),e._v(" "),e.handleType?e._e():n("span",{staticStyle:{"padding-right":"8px"}},[n("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"text"},on:{click:function(){return e.addNode(i)}}},[e._v("\u65b0\u589e")]),e._v(" "),n("el-button",{attrs:{icon:"el-icon-edit",size:"mini",type:"text"},on:{click:function(){return e.editNode(i)}}},[e._v("\u7f16\u8f91")]),e._v(" "),a.isLeaf?n("el-button",{attrs:{icon:"el-icon-delete",size:"mini",type:"text"},on:{click:function(){return e.deleteNode(i)}}},[e._v("\u5220\u9664")]):e._e()],1)])}}])})],1)],1),e._v(" "),e.handleType?n("el-col",{staticClass:"h-full",staticStyle:{"padding-left":"4px","padding-right":"16px"}},[n("content-main",{attrs:{"title-height":"48px","show-flag":!1},scopedSlots:e._u([{key:"title",fn:function(){return[n("span",{staticStyle:{"font-size":"14px","font-weight":"bold"}},[e._v(e._s(e.handleTitle))])]},proxy:!0},{key:"right",fn:function(){return[e.handleType?n("el-button",{attrs:{size:"mini"},on:{click:e.cancle}},[e._v("\u5173\u95ed")]):e._e(),e._v(" "),e.handleType?n("el-button",{staticStyle:{"margin-right":"18px"},attrs:{size:"mini"},on:{click:e.confirmRole}},[e._v("\u4fdd\u5b58")]):e._e()]},proxy:!0}],null,!1,836999009)},[e._v(" "),e._v(" "),e.handleType?n("el-form",{ref:"form",staticStyle:{padding:"10px 16px","max-width":"460px"},attrs:{model:e.menu,rules:e.menuRules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"\u540d\u79f0",prop:"label"}},[n("el-input",{attrs:{maxlength:"10"},model:{value:e.menu.label,callback:function(t){e.$set(e.menu,"label",t)},expression:"menu.label"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"\u8def\u7531",prop:"page"}},[n("el-select",{attrs:{filterable:"",clearable:"",placeholder:"\u8bf7\u9009\u62e9\u8def\u7531"},model:{value:e.menu.page,callback:function(t){e.$set(e.menu,"page",t)},expression:"menu.page"}},e._l(e.pages,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"\u56fe\u6807",prop:"icon"}},[n("el-select",{attrs:{clearable:"",placeholder:"\u8bf7\u9009\u62e9\u56fe\u6807"},model:{value:e.menu.icon,callback:function(t){e.$set(e.menu,"icon",t)},expression:"menu.icon"}},e._l(e.icons,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[n("svg-icon",{attrs:{"icon-class":t.value,"class-name":"disabled"}}),e._v(" "),n("span",{staticStyle:{"padding-left":"10px"}},[e._v(e._s(t.label))])],1)})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"\u9690\u85cf",prop:"hidden"}},[n("el-switch",{model:{value:e.menu.hidden,callback:function(t){e.$set(e.menu,"hidden",t)},expression:"menu.hidden"}})],1)],1):e._e()],1)],1):e._e()],1)},i=[],r=n("a34a"),s=n.n(r),l=n("c96f"),o=n("a18c");function c(e){return p(e)||d(e)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function d(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function p(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(n,!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t,n,a,i,r,s){try{var l=e[r](s),o=l.value}catch(e){return void n(e)}l.done?t(o):Promise.resolve(o).then(a,i)}function v(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function s(e){g(r,a,i,s,l,"next",e)}function l(e){g(r,a,i,s,l,"throw",e)}s(void 0)}))}}var y={id:"",parentId:0,label:"",icon:"",page:"",hidden:!1,sort:0},b={name:"Menu",data:function(){return{listLoading:!0,pages:[],icons:[],menuList:[],menu:null,handleType:"",menuRules:{label:[{required:!0,message:"\u8bf7\u8f93\u5165\u83dc\u5355\u540d\u79f0",trigger:["blur","change"]}],icon:[],page:[],hidden:[]}}},computed:{handleTitle:function(){return"add"===this.handleType?"\u6dfb\u52a0\u5b50\u83dc\u5355":"root"===this.handleType?"\u6dfb\u52a0\u6839\u83dc\u5355":"edit"===this.handleType?"\u7f16\u8f91\u83dc\u5355":""}},created:function(){this.getMenus(),this.pages=this.transRoutes(o["a"]),this.getIcons()},methods:{getMenus:function(){var e=v(s.a.mark((function e(){var t;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.listLoading=!0,e.next=4,this.$store.dispatch("permission/getMenus");case 4:t=e.sent,this.menuList=t.data,this.listLoading=!1,e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),this.listLoading=!1;case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}(),getIcons:function(){this.icons=l["a"].map((function(e){return{value:e,label:e}}))},transRoutes:function(e){var t=this,n=[];return e.forEach((function(e){var a=f({},e);a.children?(a.children=t.transRoutes(a.children),a.children.length>0&&(n=[].concat(c(n),c(a.children)))):a.name&&n.push({value:a.name,label:a.meta&&a.meta.title?a.meta.title:a.name})})),n},generateIconCode:function(e){return'<svg-icon icon-class="'.concat(e,'" />')},addRootNode:function(){this.handleType="root",this.menu=Object.assign({},y);var e=this.menuList.length;e>0&&(this.menu.sort=this.menuList[e-1].sort+1)},deleteNode:function(e){var t=this;this.$confirm("\u786e\u8ba4\u5220\u9664\u300e".concat(e.label,"\u300f?"),"Warning",{confirmButtonText:"\u786e\u8ba4",cancelButtonText:"\u53d6\u6d88",type:"warning"}).then(v(s.a.mark((function n(){var a,i;return s.a.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,t.$store.dispatch("permission/deleteMenu",e.id);case 3:a=n.sent,i=a.msg,t.getMenus(),t.$message({type:"success",message:i}),n.next=12;break;case 9:n.prev=9,n.t0=n["catch"](0);case 12:case"end":return n.stop()}}),n,null,[[0,9]])}))))},addNode:function(e){if(this.handleType="add",this.menu=Object.assign({},y),this.menu.parentId=e.id,e.children&&e.children.length>0){var t=e.children.length;this.menu.sort=e.children[t-1].sort+1}},editNode:function(e){this.handleType="edit",this.menu=e},confirmRole:function(){var e=this;this.$refs.form.validate((function(t){if(!t)return!1;e.loading=!0,e.submit()}))},submit:function(){var e=v(s.a.mark((function e(){var t,n,a,i,r,l;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t="",n={hidden:this.menu.hidden,icon:this.menu.icon,label:this.menu.label,id:this.menu.id,page:this.menu.page,parentId:this.menu.parentId,sort:this.menu.sort},e.prev=2,"add"!==this.handleType&&"root"!==this.handleType){e.next=11;break}return e.next=6,this.$store.dispatch("permission/addMenu",n);case 6:a=e.sent,i=a.msg,t=i,e.next=17;break;case 11:if("edit"!==this.handleType){e.next=17;break}return e.next=14,this.$store.dispatch("permission/updateMenu",n);case 14:r=e.sent,l=r.msg,t=l;case 17:this.getMenus(),this.$message({message:t,type:"success"}),this.cancle(),e.next=25;break;case 22:e.prev=22,e.t0=e["catch"](2);case 25:case"end":return e.stop()}}),e,this,[[2,22]])})));function t(){return e.apply(this,arguments)}return t}(),cancle:function(){var e=this;this.$refs["form"].resetFields(),this.$nextTick((function(){e.menu=null,e.handleType=""}))},allowDrag:function(e){return!this.handleType},handleDragStart:function(e,t){},handleDragEnd:function(e,t,n,a){var i=["\u7ed3\u675f:"],r=t&&t.label;"none"===n?i.push("\u4f4d\u7f6e\u65e0\u53d8\u5316"):"before"===n?i.push("\u62d6\u62fd\u5230\u3010"+r+"\u3011\u8282\u70b9\u524d"):"after"===n?i.push("\u62d6\u62fd\u5230\u3010"+r+"\u3011\u8282\u70b9\u540e"):"inner"===n&&i.push("\u62d6\u62fd\u5230\u3010"+r+"\u3011\u8282\u70b9\u5185")},handleDrop:function(){var e=v(s.a.mark((function e(t,n,a,i){var r,l,o,u,d,p,h,f;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=[],l=t.data.id,"before"===a||"after"===a?(o=0,u=[],n.parent&&0!==n.parent.level?(o=n.parent.data.id,u=c(n.parent.data.children)):u=c(this.menuList),u.forEach((function(e,t){var n=e.id;r.push({id:n,parentId:o,sort:t})}))):"inner"===a&&(d=n.data.id,p=n.data.children.length-1,r.push({id:l,parentId:d,sort:p})),e.prev=5,e.next=8,this.$store.dispatch("permission/updateList",r);case 8:h=e.sent,f=h.msg,this.getMenus(),this.$message({message:f,type:"success"}),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](5);case 17:case"end":return e.stop()}}),e,this,[[5,14]])})));function t(t,n,a,i){return e.apply(this,arguments)}return t}()}},x=b,_=(n("8e31"),n("2877")),w=Object(_["a"])(x,a,i,!1,null,"7c9c4774",null);t["default"]=w.exports},"7dc0":function(e,t,n){},"8e31":function(e,t,n){"use strict";var a=n("7dc0"),i=n.n(a);i.a},c96f:function(e,t,n){"use strict";var a=n("23f1"),i=function(e){return e.keys()},r=/\.\/(.*)\.svg/,s=i(a).map((function(e){return e.match(r)[1]}));t["a"]=s}}]);